<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>مشغل الفيديو الاحترافي</title>
    <link href="https://vjs.zencdn.net/8.10.0/video-js.css" rel="stylesheet" />
    <style>
        :root {
            --vjs-theme-primary: #ff5722;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Tajawal', sans-serif;
            background: #000;
            color: #fff;
            overflow: hidden;
            height: 100vh;
            overscroll-behavior-y: contain;
        }
        
        #player-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            z-index: 1;
        }
        
        .video-js {
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
        }
        
        .orientation-warning {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.9);
            display: flex;
            justify-content: center;
            align-items: center;
            flex-direction: column;
            z-index: 10000;
            text-align: center;
            padding: 20px;
            display: none;
        }
        
        .orientation-warning h2 {
            font-size: 1.5rem;
            margin-bottom: 20px;
        }
        
        .vjs-control-bar {
            background: rgba(0,0,0,0.7) !important;
        }
        
        @media screen and (orientation: portrait) {
            .orientation-warning {
                display: flex;
            }
        }
    </style>
</head>
<body>
    <!-- تحذير اتجاه الشاشة -->
    <div class="orientation-warning">
        <h2>الرجاء تدوير الجهاز إلى الوضع الأفقي</h2>
        <p>لتحسين تجربة المشاهدة</p>
    </div>
    
    <!-- مشغل الفيديو -->
    <div id="player-container">
        <video-js id="player" class="video-js vjs-big-play-centered" playsinline>
            <p class="vjs-no-js">
                الرجاء تمكين الجافاسكريبت لمشاهدة الفيديو
            </p>
        </video-js>
    </div>

    <!-- مكتبات الجافاسكربت -->
    <script src="https://vjs.zencdn.net/8.10.0/video.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // قنوات البث
            const channels = [
                {
                    name: "DEN SPORTS 2",
                    src: "https://www.sportlo.live/DEN-SPORTS-2/tracks-v1a1/mono.m3u8",
                    poster: "https://via.placeholder.com/1280x720/333/fff?text=DEN+SPORTS+2"
                },
                {
                    name: "bein 3",
                    src: "https://www.sportlo.live/BEIN-3/tracks-v1a1/mono.m3u8",
                    poster: "https://via.placeholder.com/1280x720/333/fff?text=BEIN+3"
                }
            ];
            
            // متغيرات المشغل
            let player;
            let hls;
            
            // تهيئة المشغل
            function initPlayer() {
                // إجبار الوضع الأفقي
                if (screen.orientation && screen.orientation.lock) {
                    screen.orientation.lock('landscape').catch(e => console.log(e));
                }
                
                // إخفاء شريط التنقل
                document.documentElement.style.overflow = 'hidden';
                document.body.style.overflow = 'hidden';
                
                // إنشاء المشغل
                player = videojs('player', {
                    fluid: true,
                    autoplay: true,
                    controls: true,
                    liveui: true,
                    poster: channels[0].poster,
                    playbackRates: [0.5, 0.75, 1, 1.25, 1.5, 2],
                    controlBar: {
                        remainingTimeDisplay: false,
                        progressControl: {
                            seekBar: true
                        },
                        pictureInPictureToggle: false
                    }
                });
                
                // تشغيل القناة الأولى
                playChannel(channels[0]);
                
                // الكشف عن اتجاه الشاشة
                window.addEventListener('resize', detectOrientation);
                detectOrientation();
                
                // إدارة الشاشة الكاملة
                player.on('fullscreenchange', function() {
                    if (!player.isFullscreen()) {
                        player.requestFullscreen();
                    }
                });
                
                // تشغيل تلقائي عند التفاعل الأول
                player.one('play', function() {
                    player.requestFullscreen();
                });
            }
            
            // تشغيل قناة محددة
            function playChannel(channel) {
                if (hls) {
                    hls.destroy();
                }
                
                if (Hls.isSupported()) {
                    hls = new Hls({
                        maxMaxBufferLength: 30,
                        maxBufferSize: 6000000,
                        maxBufferLength: 30,
                        enableWorker: true
                    });
                    
                    hls.loadSource(channel.src);
                    hls.attachMedia(player.tech().el());
                    
                    hls.on(Hls.Events.MANIFEST_PARSED, function() {
                        player.poster(channel.poster);
                        player.play().catch(e => {
                            // إذا فشل التشغيل التلقائي، ننتظر تفاعل المستخدم
                            player.one('click', function() {
                                player.play();
                            });
                        });
                    });
                    
                    hls.on(Hls.Events.ERROR, function(event, data) {
                        if (data.fatal) {
                            switch(data.type) {
                                case Hls.ErrorTypes.NETWORK_ERROR:
                                    hls.startLoad();
                                    break;
                                case Hls.ErrorTypes.MEDIA_ERROR:
                                    hls.recoverMediaError();
                                    break;
                                default:
                                    initPlayer();
                                    break;
                            }
                        }
                    });
                } else if (player.tech().el().canPlayType('application/vnd.apple.mpegurl')) {
                    player.src({
                        src: channel.src,
                        type: 'application/vnd.apple.mpegurl'
                    });
                    player.poster(channel.poster);
                    player.play();
                }
            }
            
            // الكشف عن اتجاه الشاشة
            function detectOrientation() {
                const warning = document.querySelector('.orientation-warning');
                if (window.innerHeight > window.innerWidth) {
                    warning.style.display = 'flex';
                } else {
                    warning.style.display = 'none';
                }
            }
            
            // بدء التشغيل عند التفاعل الأول
            document.body.addEventListener('click', function initPlay() {
                initPlayer();
                document.body.removeEventListener('click', initPlay);
            }, { once: true });
        });
    </script>
</body>
</html>
